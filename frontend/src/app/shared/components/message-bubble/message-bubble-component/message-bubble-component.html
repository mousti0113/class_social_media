<div class="flex w-full" [ngClass]="alignmentClasses()">
  <div class="flex flex-col" [class.items-end]="isMine()" [class.items-start]="!isMine()">
    <!-- Bolla messaggio -->
    <div [ngClass]="bubbleClasses()">
      <!-- Immagine allegata -->
      @if (imageUrl()) {
        <div class="mb-2 -mx-2 -mt-1">
          <img
            [src]="imageUrl()"
            alt="Immagine allegata"
            class="rounded-xl max-w-full h-auto cursor-pointer hover:opacity-90 transition-opacity"
            loading="lazy"
          />
        </div>
      }

      <!-- Contenuto testuale -->
      @if (contenuto()) {
        <p class="text-sm whitespace-pre-wrap break-words">{{ contenuto() }}</p>
      }
    </div>

    <!-- Footer: timestamp e stato lettura -->
    @if (showTimestamp()) {
      <div [ngClass]="timestampClasses()" class="flex items-center gap-1">
        <app-time-ago [date]="createdAt()" />

        <!-- Stato lettura (solo per messaggi inviati) -->
        @if (shouldShowReadStatus()) {
          <span class="mx-1">Â·</span>
          <span [class.text-primary-500]="isRead()">
            {{ readStatusText() }}
          </span>
        }
      </div>
    }
  </div>
</div>